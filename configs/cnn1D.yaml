# SAMoSA-style 1D CNN architecture
cnn1d:
  encoder:
    conv_filters: [128, 128, 256, 256]
    kernel_size: 10
    stride: 1
    padding: 0               # SAMoSA uses no padding (valid convolution)
    use_batch_norm: true
    pool_size: 2
    pool_every: 2             # MaxPool after every 2nd conv layer (SAMoSA: after Conv2 and Conv4)
    dropout: 0.5
    fc_dims: [1000, 500, 250]

# Objective: "mae" (self-supervised) or "supervised" (classification)
objective:
  type: supervised         # mae | supervised

# Data: override base.yaml to train on a specific dataset
# Set train_on_datasets to the target dataset(s) for supervised training
# Set probe_dataset to null so the target dataset isn't excluded from train/val/test
data:
  train_on_datasets: [prism]  # change to target dataset, e.g. [samosa], [prism], or [samosa, prism]

splits:
  probe_dataset: null          # don't exclude any dataset from supervised splits
  test_ratio: 0.1

trainer:
  seed: 42
  amp: true
  max_steps: 100
  grad_clip_norm: 1.0
  grad_accum_steps: 1
  val_every_steps: 10

  optim:
    name: adam
    lr: 0.001
    weight_decay: 0.0
    betas: [0.9, 0.999]
    eps: 1.0e-8

  sched:
    name: reduce_on_plateau
    monitor: val_loss
    patience: 5
    factor: 0.5

  early_stopping:
    enabled: true
    monitor: val_loss
    patience: 10
