# ViT-MAE needs spectrogram input [3, F, TT]
spectrogram:
  enabled: true

objective:
  mask_ratio: 0.75
  norm_pix_loss: false

vit:
  warm_start: true
  pretrained_id: facebook/vit-mae-base
  resize_hw: [224, 224]
  patch_size: 16
  num_channels: 3

encoder: # arch params (used only when warm_start=false)
  hidden_size: 768
  num_hidden_layers: 12
  num_attention_heads: 12
  intermediate_size: 3072
  hidden_act: gelu
  hidden_dropout_prob: 0.0
  attention_probs_dropout_prob: 0.0
  qkv_bias: true
  layer_norm_eps: 1.0e-12
  initializer_range: 0.02
  pooling: mean  # mean | cls

decoder: # arch params (used only when warm_start=false)
  hidden_size: 512
  num_hidden_layers: 8
  num_attention_heads: 16
  intermediate_size: 2048
  hidden_dropout_prob: 0.0
  attention_probs_dropout_prob: 0.0
  hidden_act: gelu

trainer:
  seed: 42
  amp: true
  max_steps: 0
  grad_clip_norm: 1.0
  grad_accum_steps: 1
  optim: adamw
  lr: 0.00015
  weight_decay: 0.05
  betas: [0.9, 0.95]
  eps: 1.0e-8
  sched: cosine
  warmup_steps: 100

