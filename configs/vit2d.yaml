# ViT-MAE needs spectrogram input [3, F, TT]
spectrogram:
  enabled: true

objective:
  type: mae                # mae | supervised
  # MAE-specific (masked_2d for HuggingFace ViTMAE)
  mask_ratio: 0.75
  norm_pix_loss: false

vit:
  warm_start: true
  pretrained_id: facebook/vit-mae-base
  resize_hw: [224, 224]
  patch_size: 16
  num_channels: 3

encoder: # arch params (used only when warm_start=false)
  hidden_size: 768
  num_hidden_layers: 12
  num_attention_heads: 12
  intermediate_size: 3072
  hidden_act: gelu
  hidden_dropout_prob: 0.0
  attention_probs_dropout_prob: 0.0
  qkv_bias: true
  layer_norm_eps: 1.0e-12
  initializer_range: 0.02
  pooling: mean  # mean | cls

decoder: # arch params (used only when warm_start=false)
  hidden_size: 512
  num_hidden_layers: 8
  num_attention_heads: 16
  intermediate_size: 2048
  hidden_dropout_prob: 0.0
  attention_probs_dropout_prob: 0.0
  hidden_act: gelu

trainer:
  seed: 42
  amp: true
  max_steps: 100
  grad_clip_norm: 1.0
  grad_accum_steps: 8
  val_every_steps: 10

  optim:
    name: adamw
    lr: 0.001
    weight_decay: 0.0001
    betas: [0.9, 0.95]
    eps: 1.0e-8

  sched:
    name: cosine
    warmup_steps: 100

  early_stopping:
    enabled: true
    monitor: val_loss
    patience: 5


